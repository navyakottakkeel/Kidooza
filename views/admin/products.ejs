

 <%-include("../../views/partials/admin/main") %>




 <div class="container-fluid" style="width:100% ;">
     <div class="d-flex justify-content-between align-items-center mb-3" style="    padding-left: 50px;">
         <div style="    width: 50%;margin-top: 30px;">
             <h2 class="fw-bold">Products</h2>
         </div>


         <form method="GET" action="/admin/users" class="d-flex gap-2 justify-content-end mb-3" style="float:right;padding-right: 50px;margin-bottom: 20px;">
             <input 
                 type="text" 
                 name="search" 
                 value="<%= search %>" 
                 class="form-control rounded-pill ps-4 pe-5" 
                 placeholder="Search here" 
                 style="width: 240px; height: 38px;"
             >
         
             <button type="submit"  style="height:38px;width:100px;background-color:black;color:white">Search
                 <i class="fas fa-search"style="padding-left: 10px; "></i></button>
         
             <% if (search) { %>
                 <a href="/admin/users" class="btn btn-outline-secondary" style="height: 38px;">Clear</a>
             <% } %>
         </form>
</div>
         


     <!-- Table -->
     <div class="table-responsive rounded-4 shadow-sm">
         <table class="table align-middle text-center table-bordered mb-0" style="width: 100%;">
             <thead class="text-white" style="background-color: #000;">
                 <tr>
                     <th>Customer</th>
                     <th>Email ID</th>
                     <th>Orders</th>
                     <th>Balance</th>
                     <th>Status</th>
                     <th>Actions</th>
                     <th>View</th>
                 </tr>
             </thead>
             <tbody>
                 <%for( let i=0; i < data.length; i++){%>
                     <tr>
                         <td class="d-flex align-items-center gap-2 justify-content-center py-3">
                             <%=data[i].name%>
                         </td>
                         <td><%=data[i].email%></td>
                         <td>73</td>
                         <td>â‚¹450</td>
                         <td>
                             <span class="badge bg-success-subtle text-success px-3 py-1 rounded-pill">
                                <%if(data[i].isBlocked === false){%>
                                 <i style="color: green ;">Active</i>
                                 <%}else{%>
                                     <i style="color:red ;">Blocked</i>
                                     <%}%>
                             </span>
                         </td>
                         <td>
                             <span >
                                <%if(data[i].isBlocked === false){%>
                                 <button  style="height:38px;width:100px;background-color:red;color:white"
                                      class="block-btn" data-id="<%= data[i]._id %>">
                                     Block
                                 </button>
                                
                                 <%}else{%>
                                     <button style="height:38px;width:100px;background-color:green;color:white" 
                                         class="unblock-btn" data-id="<%= data[i]._id %>">Unblock</button>
                                     <%}%>
                             </span>
                         </td>
                         <td>
                             <button style="height:38px;width:100px;background-color:black;color:white" class="btn btn-success">View More</button>
                         </td>
                     </tr>
                     <%}%>
             </tbody>
         </table>


         <nav class="mt-3 d-flex justify-content-center">
             <ul class="pagination">
                 <% for (let i = 1; i <= totalPages; i++) { %>
                     <li class="page-item <%= currentPage == i ? 'active' : '' %>">
                         <a class="page-link" href="/admin/users?page=<%= i %><%= search ? '&search=' + search : '' %>"><%= i %></a>
                     </li>
                 <% } %>
             </ul>
         </nav>

         


     
 </div>


 <script>
     document.addEventListener('DOMContentLoaded', function () {
         const blockButtons = document.querySelectorAll('.block-btn');
         const unblockButtons = document.querySelectorAll('.unblock-btn');
 
         blockButtons.forEach(button => {
             button.addEventListener('click', function () {
                 const userId = this.dataset.id;
                 Swal.fire({
                     title: 'Are you sure?',
                     text: "You want to block this customer",
                     icon: 'warning',
                     showCancelButton: true,
                     confirmButtonColor: '#d33',
                     cancelButtonColor: '#3085d6',
                     confirmButtonText: 'Yes, block'
                 }).then((result) => {
                     if (result.isConfirmed) {
                         window.location.href = `/admin/blockCustomer?id=${userId}`;
                     }
                 });
             });
         });
 
         unblockButtons.forEach(button => {
             button.addEventListener('click', function () {
                 const userId = this.dataset.id;
                 Swal.fire({
                     title: 'Are you sure?',
                     text: "You want to unblock this customer",
                     icon: 'question',
                     showCancelButton: true,
                     confirmButtonColor: '#28a745',
                     cancelButtonColor: '#d33',
                     confirmButtonText: 'Yes, unblock'
                 }).then((result) => {
                     if (result.isConfirmed) {
                         window.location.href = `/admin/unblockCustomer?id=${userId}`;
                     }
                 });
             });
         });
     });
 </script>


<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
